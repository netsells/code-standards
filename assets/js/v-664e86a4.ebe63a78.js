"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4618],{9217:(e,n,t)=>{t.r(n),t.d(n,{default:()=>K});var s=t(6252),l=t(1915),a=t(5396),r=t(9631);const i=(0,s._)("h1",{id:"multiple-firebase-environments",tabindex:"-1"},[(0,s._)("a",{class:"header-anchor",href:"#multiple-firebase-environments","aria-hidden":"true"},"#"),(0,s.Uk)(" Multiple Firebase Environments")],-1),o=(0,s._)("p",null,[(0,s.Uk)("If you're using Firebase for your Flutter app, you "),(0,s._)("strong",null,"must"),(0,s.Uk)(" set up multiple environments for staging and production versions of the app. This ensures that any data is kept separate, and access can be tailored to suit the environment.")],-1),u=(0,s._)("p",null,"This guide will take you through the process of configuring a Flutter app to work with multiple Firebase projects.",-1),p=(0,s._)("h2",{id:"step-1-create-firebase-projects",tabindex:"-1"},[(0,s._)("a",{class:"header-anchor",href:"#step-1-create-firebase-projects","aria-hidden":"true"},"#"),(0,s.Uk)(" Step 1: Create Firebase projects")],-1),c=(0,s._)("p",null,"You'll need to create 2 Firebase projects in the usual way for your app. Our naming convention is [App Name] - [Environment].",-1),d=(0,s._)("p",null,"For example, for Flexed, our projects are:",-1),_=(0,s._)("ul",null,[(0,s._)("li",null,"Flexed - Staging"),(0,s._)("li",null,"Flexed - Production")],-1),g=(0,s._)("p",null,[(0,s.Uk)("Within each project, create iOS and Android apps. Ignore the setup steps for now, but download the relevant configuration files (the "),(0,s._)("code",null,"google-services.json"),(0,s.Uk)(" and "),(0,s._)("code",null,"GoogleService-Info.plist"),(0,s.Uk)(" files).")],-1),h=(0,s._)("p",null,[(0,s.Uk)("The bundle IDs should be the same "),(0,s._)("strong",null,"except"),(0,s.Uk)(" that the staging IDs should have the "),(0,s._)("code",null,".stg"),(0,s.Uk)(" suffix:")],-1),b=(0,s._)("ul",null,[(0,s._)("li",null,[(0,s.Uk)("Staging: "),(0,s._)("code",null,"uk.co.flexed.stg")]),(0,s._)("li",null,[(0,s.Uk)("Production: "),(0,s._)("code",null,"uk.co.flexed")])],-1),f=(0,s._)("p",null,"Finally, set up any Firebase products you may need (App Distribution, Analytics etc).",-1),k=(0,s._)("h2",{id:"step-2-set-up-firebase-in-your-app",tabindex:"-1"},[(0,s._)("a",{class:"header-anchor",href:"#step-2-set-up-firebase-in-your-app","aria-hidden":"true"},"#"),(0,s.Uk)(" Step 2: Set up Firebase in your app")],-1),m=(0,s.Uk)("Follow the setup steps linked "),U={href:"https://firebase.flutter.dev/docs/overview",target:"_blank",rel:"noopener noreferrer"},v=(0,s.Uk)("here"),S=(0,s.Uk)(" to integrate Firebase into your app, including the platform-specific installation guides for iOS and Android. However, "),I=(0,s._)("strong",null,"don't",-1),y=(0,s.Uk)(" add the configuration files yet."),T=(0,s._)("h2",{id:"step-3-android-configuration-setup",tabindex:"-1"},[(0,s._)("a",{class:"header-anchor",href:"#step-3-android-configuration-setup","aria-hidden":"true"},"#"),(0,s.Uk)(" Step 3: Android configuration setup")],-1),w=(0,s._)("p",null,[(0,s.Uk)("We first need to create product flavors for the staging and production environments. In the "),(0,s._)("code",null,"android/app/build.gradle"),(0,s.Uk)(" file, in the "),(0,s._)("code",null,"android"),(0,s.Uk)(" section, add the following:")],-1),R=(0,s._)("div",{class:"language-groovy ext-groovy line-numbers-mode"},[(0,s._)("pre",{class:"language-groovy"},[(0,s._)("code",null,[(0,s.Uk)("flavorDimensions "),(0,s._)("span",{class:"token string gstring"},'"env"'),(0,s.Uk)("\nproductFlavors "),(0,s._)("span",{class:"token punctuation"},"{"),(0,s.Uk)("\n\tproduction "),(0,s._)("span",{class:"token punctuation"},"{"),(0,s.Uk)("\n\t\tdimension "),(0,s._)("span",{class:"token string gstring"},'"env"'),(0,s.Uk)("\n\t\tapplicationIdSuffix "),(0,s._)("span",{class:"token string gstring"},'""'),(0,s.Uk)("\n\t\tresValue "),(0,s._)("span",{class:"token string gstring"},'"string"'),(0,s._)("span",{class:"token punctuation"},","),(0,s.Uk)(),(0,s._)("span",{class:"token string gstring"},'"app_name"'),(0,s._)("span",{class:"token punctuation"},","),(0,s.Uk)(),(0,s._)("span",{class:"token string gstring"},'"{{INSERT YOUR APP NAME HERE}}"'),(0,s.Uk)("\n\t"),(0,s._)("span",{class:"token punctuation"},"}"),(0,s.Uk)("\n\tstaging "),(0,s._)("span",{class:"token punctuation"},"{"),(0,s.Uk)("\n\t\tdimension "),(0,s._)("span",{class:"token string gstring"},'"env"'),(0,s.Uk)("\n\t\tapplicationIdSuffix "),(0,s._)("span",{class:"token string gstring"},'".stg"'),(0,s.Uk)("\n\t\tresValue "),(0,s._)("span",{class:"token string gstring"},'"string"'),(0,s._)("span",{class:"token punctuation"},","),(0,s.Uk)(),(0,s._)("span",{class:"token string gstring"},'"app_name"'),(0,s._)("span",{class:"token punctuation"},","),(0,s.Uk)(),(0,s._)("span",{class:"token string gstring"},'"{{INSERT YOUR APP NAME HERE}} [STG]"'),(0,s.Uk)("\n\t"),(0,s._)("span",{class:"token punctuation"},"}"),(0,s.Uk)("\n"),(0,s._)("span",{class:"token punctuation"},"}"),(0,s.Uk)("\n")])]),(0,s._)("div",{class:"line-numbers"},[(0,s._)("span",{class:"line-number"},"1"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"2"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"3"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"4"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"5"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"6"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"7"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"8"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"9"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"10"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"11"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"12"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"13"),(0,s._)("br")])],-1),F=(0,s._)("p",null,[(0,s.Uk)("Then, copy the "),(0,s._)("code",null,"google-services.json"),(0,s.Uk)(" files we downloaded earlier into the following directories:")],-1),x=(0,s._)("ul",null,[(0,s._)("li",null,[(0,s.Uk)("Production: "),(0,s._)("code",null,"android/app/src/production")]),(0,s._)("li",null,[(0,s.Uk)("Staging: "),(0,s._)("code",null,"android/app/src/staging")])],-1),N=(0,s._)("p",null,"That's it!",-1),O=(0,s._)("h2",{id:"step-4-ios-configuration-setup",tabindex:"-1"},[(0,s._)("a",{class:"header-anchor",href:"#step-4-ios-configuration-setup","aria-hidden":"true"},"#"),(0,s.Uk)(" Step 4: iOS Configuration Setup")],-1),A=(0,s._)("h3",{id:"add-your-plist-files",tabindex:"-1"},[(0,s._)("a",{class:"header-anchor",href:"#add-your-plist-files","aria-hidden":"true"},"#"),(0,s.Uk)(" Add your PLIST files")],-1),P=(0,s._)("p",null,[(0,s.Uk)("Take the "),(0,s._)("code",null,"GoogleService-Info.plist"),(0,s.Uk)(" files we downloaded from Firebase earlier and rename them as follows:")],-1),C=(0,s._)("ul",null,[(0,s._)("li",null,[(0,s.Uk)("Staging: "),(0,s._)("code",null,"GoogleService-Info-stg.plist")]),(0,s._)("li",null,[(0,s.Uk)("Production: "),(0,s._)("code",null,"GoogleService-Info-prod.plist")])],-1),E=(0,s._)("p",null,[(0,s.Uk)("Then, create a directory under "),(0,s._)("code",null,"ios/Runner"),(0,s.Uk)(" called "),(0,s._)("code",null,"Firebase"),(0,s.Uk)(", and move the PLIST files into that folder. "),(0,s._)("strong",null,"Don't use Xcode for this step!")],-1),D=(0,s._)("p",null,"Next, open Xcode, and drag the Firebase directory we just created into the project.",-1),G=(0,s._)("p",null,[(0,s._)("strong",null,'Be sure to uncheck "Copy items if needed" and all targets under "Add to targets".')],-1),j=(0,s._)("p",null,[(0,s._)("img",{src:l,alt:"image"})],-1),$=(0,s._)("h3",{id:"create-custom-schemes",tabindex:"-1"},[(0,s._)("a",{class:"header-anchor",href:"#create-custom-schemes","aria-hidden":"true"},"#"),(0,s.Uk)(" Create custom schemes")],-1),L=(0,s._)("p",null,[(0,s.Uk)("In Xcode again, go to "),(0,s._)("strong",null,"Product → Scheme → Manage Schemes"),(0,s.Uk)(', and use the + button to create two new schemes, targeting "Runner", named '),(0,s._)("code",null,"production"),(0,s.Uk)(" and "),(0,s._)("code",null,"staging"),(0,s.Uk)(":")],-1),M=(0,s._)("p",null,[(0,s._)("img",{src:a,alt:"image"})],-1),B=(0,s._)("p",null,[(0,s._)("em",null,"Make sure the Shared checkbox is enabled for each of these new schemes.")],-1),H=(0,s._)("p",null,"Now select the Runner project and check that you have the following configurations set up:",-1),X=(0,s._)("p",null,[(0,s._)("img",{src:r,alt:"image"})],-1),Y=(0,s._)("h3",{id:"add-a-new-run-script-build-phase",tabindex:"-1"},[(0,s._)("a",{class:"header-anchor",href:"#add-a-new-run-script-build-phase","aria-hidden":"true"},"#"),(0,s.Uk)(" Add a new Run Script build phase")],-1),W=(0,s._)("p",null,[(0,s.Uk)("Select the Runner target in Xcode and go to "),(0,s._)("strong",null,"Build Phases"),(0,s.Uk)(". Use the + button to add a new Run Script phase, and paste the following script:")],-1),J=(0,s._)("div",{class:"language-Bash ext-Bash line-numbers-mode"},[(0,s._)("pre",{class:"language-Bash"},[(0,s._)("code",null,'PLIST_DESTINATION=${BUILT_PRODUCTS_DIR}/${PRODUCT_NAME}.app\n\nif [ "${CONFIGURATION}" == "Debug-staging" ] || [ "${CONFIGURATION}" == "Release-staging" ] || [ "${CONFIGURATION}" == "Profile-staging" ]; then\ncp -r "${PROJECT_DIR}/Runner/Firebase/GoogleService-Info-stg.plist" "${PLIST_DESTINATION}/GoogleService-Info.plist"\necho "Staging plist copied"\nelif [ "${CONFIGURATION}" == "Debug-production" ] || [ "${CONFIGURATION}" == "Release-production" ] || [ "${CONFIGURATION}" == "Profile-production" ]; then\ncp -r "${PROJECT_DIR}/Runner/Firebase/GoogleService-Info-prod.plist" "${PLIST_DESTINATION}/GoogleService-Info.plist"\necho "Production plist copied"\nfi\n\n')]),(0,s._)("div",{class:"line-numbers"},[(0,s._)("span",{class:"line-number"},"1"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"2"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"3"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"4"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"5"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"6"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"7"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"8"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"9"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"10"),(0,s._)("br")])],-1),V=(0,s._)("p",null,"This script will copy the relevant PLIST file into the final app binary.",-1),Z=(0,s._)("h2",{id:"step-5-run-or-build-using-the-correct-flavor",tabindex:"-1"},[(0,s._)("a",{class:"header-anchor",href:"#step-5-run-or-build-using-the-correct-flavor","aria-hidden":"true"},"#"),(0,s.Uk)(" Step 5: Run or build using the correct flavor")],-1),q=(0,s._)("p",null,[(0,s.Uk)("Now, whenever you build or run the app, simply add "),(0,s._)("code",null,"--flavor staging"),(0,s.Uk)(" or "),(0,s._)("code",null,"--flavor production"),(0,s.Uk)(" to the command to specify which flavour you need.")],-1),z={},K=(0,t(3744).Z)(z,[["render",function(e,n){const t=(0,s.up)("OutboundLink");return(0,s.wg)(),(0,s.iD)(s.HY,null,[i,o,u,p,c,d,_,g,h,b,f,k,(0,s._)("p",null,[m,(0,s._)("a",U,[v,(0,s.Wm)(t)]),S,I,y]),T,w,R,F,x,N,O,A,P,C,E,D,G,j,$,L,M,B,H,X,Y,W,J,V,Z,q],64)}]])},3744:(e,n)=>{n.Z=(e,n)=>{for(const[t,s]of n)e[t]=s;return e}},2223:(e,n,t)=>{t.r(n),t.d(n,{data:()=>s});const s={key:"v-664e86a4",path:"/flutter/multiple-firebase-environments.html",title:"Multiple Firebase Environments",lang:"en-US",frontmatter:{},excerpt:"",headers:[{level:2,title:"Step 1: Create Firebase projects",slug:"step-1-create-firebase-projects",children:[]},{level:2,title:"Step 2: Set up Firebase in your app",slug:"step-2-set-up-firebase-in-your-app",children:[]},{level:2,title:"Step 3: Android configuration setup",slug:"step-3-android-configuration-setup",children:[]},{level:2,title:"Step 4: iOS Configuration Setup",slug:"step-4-ios-configuration-setup",children:[{level:3,title:"Add your PLIST files",slug:"add-your-plist-files",children:[]},{level:3,title:"Create custom schemes",slug:"create-custom-schemes",children:[]},{level:3,title:"Add a new Run Script build phase",slug:"add-a-new-run-script-build-phase",children:[]}]},{level:2,title:"Step 5: Run or build using the correct flavor",slug:"step-5-run-or-build-using-the-correct-flavor",children:[]}],filePathRelative:"flutter/multiple-firebase-environments.md",git:{updatedTime:1658216277e3,contributors:[{name:"Sam Turrell",email:"sam.turrell@netsells.co.uk",commits:1}]}}},1915:(e,n,t)=>{e.exports=t.p+"assets/img/firebase-1.beabebe9.png"},5396:(e,n,t)=>{e.exports=t.p+"assets/img/firebase-2.c3a2bf50.png"},9631:(e,n,t)=>{e.exports=t.p+"assets/img/firebase-3.a6eb7b45.png"}}]);